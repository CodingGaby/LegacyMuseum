---
import BackBtn from "@components/ui/Buttons/BackBtn.astro";
import Layout from "src/layouts/Layout.astro";
import SupplierForm from "@components/Supplier/SupplierForm.astro";
import { turso } from "src/turso";
import SubmitBtn from "@components/ui/Buttons/SubmitBtn.astro";
import AddRegisterBtn from "@components/ui/Buttons/AddRegisterBtn.astro";

if (Astro.request.method === 'POST') {
    // Parse form data
    const formData = await Astro.request.formData();

    const supplierID = formData.get('supplierID');
    const legalEntityID = formData.get('legalEntityID');
    const phoneNumber = formData.get('phoneNumber');
    const email = formData.get('email');
    const statusID = formData.get('statusID');

    await turso.execute(`INSERT INTO Suppliers (supplierID, legalEntityID, phoneNumber, email, statusID) VALUES(${supplierID}, '${legalEntityID}', '${phoneNumber}', '${email}', ${statusID})`);

    console.log(supplierID);
    console.log(legalEntityID);
    console.log(phoneNumber);
    console.log(email);
    console.log(statusID);

  return Astro.redirect('/suppliers')
}

---

<Layout title="Proveedores">
  <SupplierForm>
    <div class="flex justify-end max-w-full mx-auto px-8">
      <BackBtn />
      <SubmitBtn>
        Add
      </SubmitBtn>
    </div>
  </SupplierForm>
</Layout>