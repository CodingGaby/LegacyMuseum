---
import BackBtn from "../../components/ui/Buttons/BackBtn.astro";
import Layout from "../../layouts/Layout.astro";
import PurchaseForm from "../../components/Purchase/PurchaseForm.astro";

import { turso } from "src/turso";

import SubmitBtn from "@components/ui/Buttons/SubmitBtn.astro";



if (Astro.request.method === 'POST') {
  // Parse form data
  const formData = await Astro.request.formData();
  const purchaseID = formData.get('purchaseID');
  const warehouseID = formData.get('warehouseID');
  const currencyID = formData.get('currencyID');
  const souvenirID = formData.get('souvenirID');
  const supplierID = formData.get('supplierID');

  await turso.execute(`INSERT INTO PurchaseOrders (purchaseOrderID ,warehouseID , currencyID ,souvenirID, supplierID, statusID ) VALUES(${purchaseID},${warehouseID},${currencyID},${souvenirID},${supplierID}, 7)`)

  return Astro.redirect('/purchaseOrders')
}
---

<Layout title="purchaseOrders">
  <PurchaseForm>
    <div class="flex justify-end max-w-full mx-auto px-8">
      <BackBtn/>
        <SubmitBtn/>
          Add
        </SubmitBtn>
    </div>
  </PurchaseForm>
</Layout>